{% extends "base.html" %}

{% block title %}Waiting{% endblock %}

{% block content %}
<p>Waiting for the other player to join...</p>
<input type="text" value="{{ request.url }}" id="gameLink" readonly>
<button onclick="copyToClipboard('gameLink')">Copy link</button>
{% endblock %}

{% block scripts %}
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js" integrity="sha384-mZLF4UVrpi/QTWPA7BjNPEnkIfRFn4ZEO3Qt/HFklTJBj/gBOV8G3HcKn4NfQblz" crossorigin="anonymous"></script>
<script type="text/javascript">
    var socket;
    document.addEventListener('DOMContentLoaded', () => {
        socket = io.connect(window.location.protocol + '//' + window.location.hostname + ':' + window.location.port);
        socket.on('connect', function() {
            socket.emit('join', {'room': window.location.pathname.split('/')[2] });
        });

        socket.on('start', function() {
            // Refresh the page to trigger the active game view.
            window.location.reload();
        });
    });
    function copyToClipboard(elementId) {
        var copyText = document.getElementById(elementId);
        copyText.select();
        document.execCommand("copy");
        window.getSelection().removeAllRanges();
    }
</script>
{% endblock %}
